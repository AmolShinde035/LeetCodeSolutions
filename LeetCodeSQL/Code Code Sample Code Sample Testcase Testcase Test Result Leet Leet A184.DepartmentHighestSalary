# Write your MySQL query statement below
-- SELECT d.name AS Department, 
--        e.name AS Employee, 
--        e.salary AS Salary
-- FROM Employee e
-- JOIN Department d ON e.departmentId = d.id
-- WHERE e.salary = (
--     SELECT MAX(salary)
--     FROM Employee
--     WHERE departmentId = e.departmentId
-- );
with resultTable as (
    select d.name as department,
    e.name as employee, 
    salary,
    rank() over(
        partition by d.name
        order by e.salary desc
    ) rk
    from employee e
    join department d
    on d.id=e.departmentId
)
select department, employee, salary from resultTable where rk =1;
